<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SIP - Proyecto Individual</title>
  <!-- Iconos FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="main-container">
    <!-- =========================
         Header y Navegación
    ========================== -->
    <header class="header">
      <img src="img/Logo SIP.png" alt="SIP Logo" class="logo-header">
      <nav class="nav-header">
        <a href="#"><i class="fa-solid fa-layer-group"></i> Proyectos</a>
        <a href="#" id="notificaciones-btn"><i class="fa-regular fa-bell"></i> Notificaciones</a>
        <div class="user-info" id="perfil-btn">
          <span class="user-avatar">D</span>
          <span class="user-name">Daniela</span>
        </div>
      </nav>
      <!-- Popover de Notificaciones -->
      <div id="notificaciones-popover" class="notificaciones-popover">
        <div class="notificaciones-content">
          <div class="notificaciones-titulo">Notificaciones</div>
          <div class="notificacion-item">
            <span class="notificacion-avatar">A</span>
            <div>
              <div class="notificacion-tipo">Respondió tu publicación</div>
              <div class="notificacion-texto">Te dare varias ideas para tu proyecto...</div>
            </div>
          </div>
          <div class="notificacion-item">
            <span class="notificacion-avatar">J</span>
            <div>
              <div class="notificacion-tipo">Respondió tu publicación</div>
              <div class="notificacion-texto">Te dare varias ideas para tu proyecto...</div>
            </div>
          </div>
          <div class="notificacion-item">
            <span class="notificacion-avatar">D</span>
            <div>
              <div class="notificacion-tipo">Comentó tu proyecto</div>
              <div class="notificacion-texto">Muchas gracias me sirvió mucho, sig...</div>
            </div>
          </div>
        </div>
      </div>
      <!-- Menú Popover de Usuario -->
      <div id="popover-menu" class="popover-menu">
        <div class="popover-arrow"></div>
        <div class="popover-content">
          <ul class="popover-list">
            <li>
              <span class="icon"><i class="fa-regular fa-user"></i></span>
              <span>Perfil</span>
            </li>
            <li>
              <span class="icon"><i class="fa-solid fa-gear"></i></span>
              <span>Configuración</span>
            </li>
            <li>
              <span class="icon"><i class="fa-regular fa-star"></i></span>
              <span>Favoritos</span>
            </li>
            <li>
              <span class="icon"><i class="fa-regular fa-circle-question"></i></span>
              <span>Ayuda</span>
            </li>
          </ul>
          <form action="/api/logout" method="POST" id="logoutForm">
            <input type="hidden" name="user_id" value="1193324003">
            <button type="submit" class="logout-btn" id="logoutBtn">Cerrar sesión</button>
          </form>
        </div>
      </div>
    </header>

    <!-- =========================
         Main - Perfil y Historial
    ========================== -->
    <main class="perfil-main">
      <!-- Panel de perfil de usuario -->
      <section class="perfil-panel">
        <div class="perfil-avatar">D</div>
        <div class="perfil-nombre">Daniela Alejandra Paz Tellez</div>
        <span class="perfil-etiqueta">Egresado</span>
        <div class="perfil-datos">
          1193324003<br>
          pazdaniela1193@gmail.com<br>
          3155577843
        </div>
        <button class="btn-eliminar-cuenta" id="btn-eliminar-cuenta">Eliminar cuenta</button>
      </section>
      <!-- Historial de proyectos del usuario -->
      <section class="perfil-historial">
        <h2 class="perfil-historial-titulo">Mi Historial</h2>
        <!-- Proyecto 1 -->
        <div class="historial-card">
          <div class="historial-titulo">Menú Restaurante APP</div>
          <div class="historial-info">
            Daniela Paz <span class="perfil-etiqueta">Egresado</span>
            <span class="historial-fecha">13 agosto 2025, 02:30 pm</span>
          </div>
          <div class="historial-carrera">Tecnología en Desarrollo de Software</div>
          <div class="historial-desc">
            App de menú para restaurante Amalia, va dirigido a los restaurantes que quieren tener más visibilidad a lo que ofrecen a sus clientes
          </div>
          <form action="/api/proyectos/abrir" method="GET" style="display:inline;">
            <input type="hidden" name="proyecto_id" value="101">
            <button type="submit" class="btn-abrir">Abrir</button>
          </form>
          <form action="/api/favoritos" method="POST" style="display:inline;" class="form-favorito">
            <input type="hidden" name="proyecto_id" value="101">
            <input type="hidden" name="user_id" value="1193324003">
            <input type="hidden" name="action" value="add">
            <button type="submit" class="proyecto-fav"><i class="fa-regular fa-star"></i></button>
          </form>
          <form action="/api/proyectos/eliminar" method="POST" style="display:inline;" class="form-eliminar-proyecto">
            <input type="hidden" name="proyecto_id" value="101">
            <input type="hidden" name="user_id" value="1193324003">
            <button type="submit" class="btn-papelera" title="Eliminar"><i class="fa-regular fa-trash-can"></i></button>
          </form>
        </div>
        <!-- Proyecto 2 -->
        <div class="historial-card">
          <div class="historial-titulo">¿Oportunidades de prácticas en empresa de software?</div>
          <div class="historial-info">
            Ana Gomez <span class="perfil-etiqueta">Egresado</span>
            <span class="historial-fecha">13 agosto 2025, 02:30 pm</span>
          </div>
          <div class="historial-carrera">Tecnología en Desarrollo de Software</div>
          <div class="historial-desc">
            La empresa TechSolutions está buscando aprendices SENA para prácticas profesionales. Requisitos: conocimientos en Java y SQL.
          </div>
          <form action="/api/proyectos/abrir" method="GET" style="display:inline;">
            <input type="hidden" name="proyecto_id" value="102">
            <button type="submit" class="btn-responder">Abrir</button>
          </form>
          <form action="/api/favoritos" method="POST" style="display:inline;" class="form-favorito">
            <input type="hidden" name="proyecto_id" value="102">
            <input type="hidden" name="user_id" value="1193324003">
            <input type="hidden" name="action" value="add">
            <button type="submit" class="proyecto-fav"><i class="fa-regular fa-star"></i></button>
          </form>
          <form action="/api/proyectos/eliminar" method="POST" style="display:inline;" class="form-eliminar-proyecto">
            <input type="hidden" name="proyecto_id" value="102">
            <input type="hidden" name="user_id" value="1193324003">
            <button type="submit" class="btn-papelera" title="Eliminar"><i class="fa-regular fa-trash-can"></i></button>
          </form>
        </div>
      </section>
    </main>

    <!-- =========================
         Modal Eliminar Cuenta
    ========================== -->
    <div id="modal-eliminar-cuenta" class="modal-eliminar-cuenta" style="display:none;">
      <div class="modal-eliminar-content">
        <div class="modal-eliminar-title">¿Esta seguro de eliminar cuenta?</div>
        <form action="/api/cuenta/eliminar" method="POST" id="form-eliminar-cuenta">
          <input type="hidden" name="user_id" value="1193324003">
          <input type="hidden" name="email" value="pazdaniela1193@gmail.com">
          <input type="hidden" name="confirmacion" value="true">
          <div class="modal-eliminar-btns">
            <button type="submit" id="btn-confirmar-eliminar" class="btn-eliminar">Eliminar</button>
            <button type="button" id="btn-cancelar-eliminar" class="btn-cancelar">Cancelar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- =========================
         Modal Responder Publicación
    ========================== -->
    <div id="modal-responder" class="modal-responder" style="display:none;">
      <div class="modal-responder-content">
        <form action="/api/publicaciones/responder" method="POST" id="form-responder">
          <input type="hidden" name="publicacion_id" value="202">
          <input type="hidden" name="user_id" value="1193324003">
          <textarea name="descripcion" class="modal-responder-textarea" placeholder="Ingrese la descripción..." required></textarea>
          <div class="modal-responder-btns">
            <button type="button" id="btn-cancelar-respuesta" class="btn-cancelar">Cancelar</button>
            <button type="submit" id="btn-publicar-respuesta" class="btn-publicar">Publicar</button>
          </div>
        </form>
      </div>
    </div>

    <!-- =========================
         Footer
    ========================== -->
    <footer class="footer">
      <div class="footer-content">
        <hr class="footer-line">
        <div class="footer-icons">
          <i class="fab fa-twitter"></i>
          <i class="fab fa-facebook-f"></i>
          <i class="fab fa-instagram"></i>
        </div>
        <hr class="footer-line">
      </div>
      <div class="footer-text">
        Copyright © 2025 SENA INTERACTIVE PORTAL
      </div>
      <div class="footer-links">
        <span>Información legal</span>
        <span>Política de privacidad</span>
      </div>
    </footer>
  </div>

  <!-- =========================
       Scripts de Interacción
  ========================== -->
  <script>
    // Interceptar todos los formularios para prevenir redirección y mostrar datos en consola
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('form').forEach(function(form) {
        form.addEventListener('submit', function(e) {
          e.preventDefault();
          
          const formData = new FormData(form);
          const method = form.method.toUpperCase();
          const action = form.action;
          
          console.log('=== ENVÍO DE FORMULARIO ===');
          console.log('Método:', method);
          console.log('Action:', action);
          console.log('Datos:');
          
          const data = {};
          for (let [key, value] of formData.entries()) {
            data[key] = value;
            console.log(`  ${key}: ${value}`);
          }
          
          alert(`Formulario enviado!\nMétodo: ${method}\nAction: ${action}\nRevisa la consola para ver los datos`);
        });
      });
    });

    // ===== MENÚ POPOVER USUARIO =====
    const perfilBtn = document.getElementById('perfil-btn');
    const popoverMenu = document.getElementById('popover-menu');

    perfilBtn.addEventListener('click', function(e) {
      e.stopPropagation();
      if (popoverMenu.style.display === 'block') {
        popoverMenu.style.display = 'none';
      } else {
        const rect = perfilBtn.getBoundingClientRect();
        popoverMenu.style.display = 'block';
        popoverMenu.style.position = 'absolute';
        popoverMenu.style.top = (rect.bottom + window.scrollY + 10) + 'px';
        popoverMenu.style.left = (rect.left + rect.width / 2 - 160) + 'px';
      }
    });

    document.addEventListener('click', function(e) {
      if (!popoverMenu.contains(e.target) && e.target !== perfilBtn) {
        popoverMenu.style.display = 'none';
      }
    });

    document.addEventListener('DOMContentLoaded', function() {
      // ===== POPOVER NOTIFICACIONES =====
      const notificacionesBtn = document.getElementById('notificaciones-btn');
      const notificacionesPopover = document.getElementById('notificaciones-popover');
      const userPanel = document.getElementById('user-panel');

      notificacionesBtn.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        if (userPanel) userPanel.style.display = 'none';
        if (notificacionesPopover.style.display === 'block') {
          notificacionesPopover.style.display = 'none';
        } else {
          const rect = notificacionesBtn.getBoundingClientRect();
          notificacionesPopover.style.display = 'block';
          notificacionesPopover.style.top = (rect.bottom + window.scrollY + 10) + 'px';
          notificacionesPopover.style.left = (rect.left + rect.width / 2 - 170) + 'px';
        }
      });

      document.addEventListener('click', function(e) {
        if (!notificacionesPopover.contains(e.target) && e.target !== notificacionesBtn) {
          notificacionesPopover.style.display = 'none';
        }
      });

      const perfilBtn = document.getElementById('perfil-btn');
      document.addEventListener('click', function(e) {
        if (perfilBtn && userPanel) {
          if (perfilBtn.contains(e.target)) {
            userPanel.style.display = userPanel.style.display === 'none' ? 'block' : 'none';
          } else if (!userPanel.contains(e.target)) {
            userPanel.style.display = 'none';
          }
        }
      });

      // Botones de estrella (favorito)
      document.querySelectorAll('.proyecto-fav').forEach(function(btn) {
        btn.addEventListener('click', function() {
          btn.classList.toggle('active');
          var icon = btn.querySelector('i');
          if (btn.classList.contains('active')) {
            icon.classList.remove('fa-regular');
            icon.classList.add('fa-solid');
          } else {
            icon.classList.remove('fa-solid');
            icon.classList.add('fa-regular');
          }
        });
      });

      // Modal eliminar cuenta
      const btnEliminarCuenta = document.getElementById('btn-eliminar-cuenta');
      const modalEliminar = document.getElementById('modal-eliminar-cuenta');
      const btnCancelarEliminar = document.getElementById('btn-cancelar-eliminar');

      if (btnEliminarCuenta && modalEliminar && btnCancelarEliminar) {
        btnEliminarCuenta.addEventListener('click', function() {
          modalEliminar.style.display = 'flex';
        });
        btnCancelarEliminar.addEventListener('click', function() {
          modalEliminar.style.display = 'none';
        });
        modalEliminar.addEventListener('click', function(e) {
          if (e.target === modalEliminar) modalEliminar.style.display = 'none';
        });
      }

      // Modal responder
      const btnCancelarRespuesta = document.getElementById('btn-cancelar-respuesta');
      const modalResponder = document.getElementById('modal-responder');
      if (btnCancelarRespuesta && modalResponder) {
        btnCancelarRespuesta.addEventListener('click', function() {
          modalResponder.style.display = 'none';
        });
      }
    });
  </script>
</body>
</html>